<?php
$types = array(
    'png' => $this->baseUrl('/fizzy_assets/images/icon/document-image.png'),
    'jpg' => $this->baseUrl('/fizzy_assets/images/icon/document-image.png'),
    'jpeg' => $this->baseUrl('/fizzy_assets/images/icon/document-image.png'),
    'bmp' => $this->baseUrl('/fizzy_assets/images/icon/document-image.png'),
    'gif' => $this->baseUrl('/fizzy_assets/images/icon/document-image.png'),
    'doc' => $this->baseUrl('/fizzy_assets/images/icon/document-word.png'),
    'docx' => $this->baseUrl('/fizzy_assets/images/icon/document-word.png'),
    'xls' => $this->baseUrl('/fizzy_assets/images/icon/document-excel.png'),
    'ppt' => $this->baseUrl('/fizzy_assets/images/icon/document-powerpoint.png'),
    'pdf' => $this->baseUrl('/fizzy_assets/images/icon/document-pdf.png'),
    'flv' => $this->baseUrl('/fizzy_assets/images/icon/document-flash-movie.png'),
    'zip' => $this->baseUrl('/fizzy_assets/images/icon/document-zipper.png'),
    'rar' => $this->baseUrl('/fizzy_assets/images/icon/document-zipper.png'),
    'txt' => $this->baseUrl('/fizzy_assets/images/icon/document-text.png'),
);
?>

<div class="media-container">
    <table class="media">
        <?php if(0 < count($this->files)) : ?>
        <tbody>
            <?php $row = 0; foreach($this->files as $fileInfo) : ?>
            <tr class="<?= (++$row % 2) === 0 ? 'even' : 'odd'; ?>">
                <td class="icon">
                    <img src="<?= (array_key_exists($fileInfo->type, $types)) ? $types[$fileInfo->type] : $this->baseUrl('/images/icon/page.png'); ?>" alt="" />
                </td>
                <td class="filename">
                    <a href="<?= $this->baseUrl('/uploads/' . $fileInfo->basename); ?>" target="_blank" title="View file">
                        <?= $fileInfo->basename; ?>
                    </a>
                </td>
                <td class="size">
                <?php if($fileInfo->size < 1024) : ?>
                <?= round($fileInfo->size, 2); ?> b
                <?php elseif((1024*1024) > $fileInfo->size) : ?>
                <?= round($fileInfo->size / 1024, 2); ?> KB
                <?php else : ?>
                <?= round($fileInfo->size / (1024*1024), 2); ?> MB
                <?php endif; ?>
                <td class="controls">
                    <?php if(is_writable($this->uploadFolder)) : ?>
                    <?= $this->linkConfirm('/fizzy/media/delete/' . urlencode($fileInfo->basename), $this->img('/fizzy_assets/images/icon/minus-button.png'), "Are you sure you want to delete {$fileInfo->basename}?", array('title' => 'Delete file')); ?>
                    <?php endif; ?>
                </td>
            </tr>
            <?php endforeach; ?>
        </tbody>
        <?php else : ?>
        <tr>
            <td colspan="4">
                No uploaded files were found. Use the form at the bottom to
                add new files.
            </td>
        </tr>
        <?php endif; ?>
    </table>
</div>